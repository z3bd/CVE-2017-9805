#!/bin/bash
mkdir ~/src
cd ~/src
wget http://mirrors.ocf.berkeley.edu/apache/tomcat/tomcat-7/v7.0.108/bin/apache-tomcat-7.0.108.tar.gz
wget https://repo1.maven.org/maven2/org/apache/struts/struts2-rest-showcase/2.5.1/struts2-rest-showcase-2.5.1.war
tar xvzf apache-tomcat-7.0.108.tar.gz
mv apache-tomcat-7.0.108 /opt/tomcat
echo -e 'export JAVA_HOME=/usr/lib/jvm/default-java\n' >> ~/.bashrc
echo -e 'export CATALINA_HOME=/opt/tomcat\n' >> ~/.bashrc
cat << EOF > /opt/tomcat/conf/tomcat-users.xml
<?xml version="1.0" encoding="UTF-8"?>
<tomcat-users xmlns="http://tomcat.apache.org/xml"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"
              version="1.0">
  <role rolename="tomcat"/>
  <role rolename="role1"/>
  <role rolename="admin-gui"/>
  <role rolename="manager-gui"/>
  <user username="tomcat" password="s3cret" roles="tomcat"/>
  <user username="both" password="s3cret" roles="tomcat,role1"/>
  <user username="role1" password="s3cret" roles="role1"/>
  <user username="admin" password="admin" roles="admin-gui"/>
  <user username="admin" password="admin" roles="manager-gui"/>
</tomcat-users>
EOF
cd /opt/tomcat/webapps
mkdir struts2-rest-showcase
cd struts2-rest-showcase
jar xvf /root/src/struts2-rest-showcase-2.5.1.war
